{% extends 'base.html' %}

{% block title %}
  Calendar
{% endblock %}

{% block head %}
  <!-- Your additional head content if any -->
  <link href="/static/calendar.css" rel="stylesheet" />
{% endblock %}

{% block content %}
  <div class="calendar-navigation">
    <button id="prevMonth">&lt; Prev</button>
    <div>{{ current_month }} {{ current_year }}</div>
    <button id="nextMonth">Next &gt;</button>
  </div>

  <div id="calendar">
    <!-- Your calendar content generated by JavaScript -->
  </div>

  <div class="modal fade" id="dateModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalLabel">Selected Date</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="modal-body">
          <p id="selectedDateText">Selected Date:</p>
          <p id="dayIdText">Day ID:</p>
          <div id="snacksListSection">
            <h6>Snacks for the Day:</h6>
            <ul id="snacksList"></ul>
          </div>
          <button type="button" class="btn btn-primary" id="createMealBtn">Create Meal</button>
          <button type="button" class="btn btn-success" id="createSnackBtn">Create Snack</button>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Meal Modal -->
  <div class="modal fade" id="mealModal" tabindex="-1" role="dialog" aria-labelledby="mealModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="mealModalLabel">Create Meal</h5>

          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="modal-body">
          <!-- Meal input form goes here -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary">Save changes</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Snack Modal -->
  <div class="modal fade" id="snackModal" tabindex="-1" role="dialog" aria-labelledby="snackModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="snackModalLabel">Create Snack</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="modal-body">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="snackType" id="createNewSnack" value="new" checked />
            <label class="form-check-label" for="createNewSnack">Create New Snack</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="snackType" id="selectExistingSnack" value="existing" />
            <label class="form-check-label" for="selectExistingSnack">Select Existing Snack</label>
          </div>

          <!-- Form for creating a new snack -->
          <form method="post" id="newSnackForm" onsubmit="submitSnackForm(); return false;" style="display: none;">
            <!-- Add your new snack form fields here -->
            <div class="form-group">
              <label for="snackName">Snack Name</label>
              <input type="text" class="form-control" id="snackName" name="snackName" required />
            </div>
            <div class="form-group">
              <label for="ingredientCalories">Calories</label>
              <input type="number" class="form-control" id="snackCalories" name="snackCalories" required />
            </div>
            <div class="form-group">
              <label for="ingredientCalories">Carbs (g)</label>
              <input type="number" class="form-control" id="snackCarbs" name="snackCarbs" required />
            </div>
            <div class="form-group">
              <label for="ingredientCalories">Proteins (g)</label>
              <input type="number" class="form-control" id="snackProteins" name="snackProteins" required />
            </div>
            <div class="form-group">
              <label for="ingredientCalories">Fats (g)</label>
              <input type="number" class="form-control" id="snackFats" name="snackFats" required />
            </div>
            <input type="hidden" id="snackSelectedDate" name="snackSelectedDate" />
            <!-- Add other fields as needed -->
            <button type="submit" class="btn btn-primary">Create Snack</button>
          </form>

        <div class="form-group" id="existingSnackDropdown" style="display: none;">
          <form method="post" action="{{ url_for('views.add_snack') }}">
            <label for="existingSnacks">Select Existing Snack</label>
            <select class="form-control" id="snackType" name="selectedSnack">
              <option value="new">Select Snack</option>
              {% for snack in saved_snacks %}
                <option value="{{ snack.name }}">{{ snack.name }}</option>
              {% endfor %}
            </select>

            <!-- Add other form elements or buttons if needed -->
            <input type="hidden" id="snackSelectedDate2" name="snackSelectedDate2" />
            <button type="submit" class="btn btn-primary">Add Snack</button>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" id="saveSnackBtn">Save changes</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  {% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
  <script src="{{ url_for('static', filename = 'calendar.js') }}"></script>
{% endblock %}
